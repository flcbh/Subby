@page "/Profile"
@using SubbyNetwork.Models.ManageViewModels
@inject NavigationManager Navigation;

<h3>Profile</h3>

<div class="alert alert-info">
    Manager your profile
</div>
<EditForm Model="@ProfileModel" OnValidSubmit="@ValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />
    <div class="form-group">
        <label>Email</label>
        <InputText id="Email" @bind-Value="ProfileModel.Email" class="form-control" />
    </div>
    <div class="form-group">
        <label>Fore name</label>
        <InputText id="Forename" @bind-Value="ProfileModel.Firstname" class="form-control" />
    </div>
    <div class="form-group">
        <label>Sur name</label>
        <InputText id="Surname" @bind-Value="ProfileModel.Lastname" class="form-control" />
    </div>
    <div class="form-group">
        <label>Phone Number</label>
        <InputText id="PhoneNumber" @bind-Value="ProfileModel.PhoneNumber" class="form-control" />
    </div>
    <br />
    <div class="form-group">
        <label>Is Trader</label> <br />
        <InputRadioGroup @bind-Value="ProfileModel.IsTrader" class="form-control">
            @foreach (var item in rdTrade)
            {
                <InputRadio Value="item" /> @item
            }
        </InputRadioGroup>
    </div>
    <br />
    <div class="form-group">
        listbox
    </div>
    <br />
    <div class="form-group">
        <label>Company Name</label>
        <InputText id="TradeName" @bind-Value="ProfileModel.TradeName" class="form-control" />
    </div>
    <div class="form-group">
        <label>Address Line 1</label>
        <InputText id="TradeAddressLine1" @bind-Value="ProfileModel.TradeAddressLine1" class="form-control" />
    </div>
    <div class="form-group">
        <label>City</label>
        <InputText id="TradeCity" @bind-Value="ProfileModel.TradeCity" class="form-control" />
    </div>
    <div class="form-group">
        <label>Post code</label>
        <InputText id="Postcode" @bind-Value="ProfileModel.TradePostcode" class="form-control" />
    </div>
    <div class="form-group">
        <label>Distance</label>
        <InputNumber id="TradeDistance" @bind-Value="ProfileModel.TradeDistance" class="form-control" />
    </div>
    <br />
    <div class="form-group">
        <label>Marketing Opt In</label> <br />
        <InputRadioGroup @bind-Value="ProfileModel.MarketingOptIn" class="form-control">
            @foreach (var item in rdTrade)
            {
                <InputRadio Value="item" /> @item
            }
        </InputRadioGroup>
    </div>
    <br />
    <div class="form-group">
        <label>Picture</label>
        <InputFile multiple="" type="file" id="Avatar" @bind-Value="ProfileModel.File" class="form-control" />
    </div>
    <br />
    <div class="form-group mt-1">
        <button type="submit" class="btn btn-primary w-100">Save Now</button>
    </div>
</EditForm>

@code {
    private ProfileViewModel ProfileModel = new ProfileViewModel();
    List<string> rdTrade = new List<string> { "True", "False" };

    private void ValidSubmit()
    {
        var successful = ProfileModel.Save(ProfileModel);

        //Not successful, don't need to do anything
        if (!successful)
            return;

        //await AuthStateProvider.Login(jwtToken);
        Navigation.NavigateTo("/login"); //Root URL
    }
}
